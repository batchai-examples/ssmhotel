{
    "has_issue": false,
    "overall_severity": "",
    "issues": [],
    "fixed_code": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE mapper\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"\u003e\n\u003cmapper namespace=\"com.bdqn.dao.ChartsMapper\"\u003e\n\n    \u003cselect id=\"getTotalPriceByYear\" resultType=\"map\"\u003e\n        select year(createdate) as years,sum(payPrice) as totalPrice from t_checkin group by year(createdate)\n    \u003c/select\u003e\n\n    \u003cselect id=\"getTotalPriceByYearOfMonth\" resultType=\"double\"\u003e\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'01')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'02')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'03')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'04')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'05')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'06')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'07')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'08')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'09')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'10')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'11')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'12')\n    \u003c/select\u003e\n\n\n    \u003cselect id=\"getQuarterTotalPriceByYear\" resultType=\"map\"\u003e\n        select\n          t2.typeName ,\n          sum(if(quarter(t1.createDate)='1',t1.`payPrice`,0)) as Q1,\n          sum(if(quarter(t1.createDate)='2',t1.`payPrice`,0)) as Q2,\n          sum(if(quarter(t1.createDate)='3',t1.`payPrice`,0)) as Q3,\n          sum(if(quarter(t1.createDate)='4',t1.`payPrice`,0)) as Q4\n        from\n          t_checkin t1\n          inner join t_room_type t2 on t2.id = t1.roomtypeid\n        where date_format(t1.`createDate`,'%Y')  = #{year}\n        group by t2.typeName\n    \u003c/select\u003e\n\n    \u003cselect id=\"getRoomTypeCountByYearAndMonth\" resultType=\"com.bdqn.vo.PieChartsVo\"\u003e\n        select\n          t2.`typeName` as name,\n          count(t1.`id`)  as value\n        from\n          t_orders t1\n          inner join t_room_type t2 on t2.id = t1.roomTypeId\n          where date_format(t1.`reserveDate`,'%Y-%m') = #{year}\n        group by t2.typeName\n    \u003c/select\u003e\n\n\n    \u003cselect id=\"getCurrentDateHotelByDate\" resultType=\"com.bdqn.vo.PieChartsVo\"\u003e\n       select t2.`typeName` as name,count(t1.id) as value from t_checkin t1\n        inner join t_room_type t2 on t2.id = t1.`roomTypeId`\n        where date_format(t1.`createDate`,'%Y-%m-%d') = #{date}\n        group by t2.`typeName`\n    \u003c/select\u003e\n\n\u003c/mapper\u003e\n",
    "original_code": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE mapper\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"\u003e\n\u003cmapper namespace=\"com.bdqn.dao.ChartsMapper\"\u003e\n\n    \u003cselect id=\"getTotalPriceByYear\" resultType=\"map\"\u003e\n        select year(createdate) as years,sum(payPrice) as totalPrice from t_checkin group by year(createdate)\n    \u003c/select\u003e\n\n    \u003cselect id=\"getTotalPriceByYearOfMonth\" resultType=\"double\"\u003e\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'01')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'02')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'03')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'04')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'05')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'06')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'07')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'08')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'09')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'10')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'11')\n        union all\n        select sum(payprice) from t_checkin where date_format(createdate,'%Y%m') = concat(#{year},'12')\n    \u003c/select\u003e\n\n\n    \u003cselect id=\"getQuarterTotalPriceByYear\" resultType=\"map\"\u003e\n        select\n          t2.typeName ,\n          sum(if(quarter(t1.createDate)='1',t1.`payPrice`,0)) as Q1,\n          sum(if(quarter(t1.createDate)='2',t1.`payPrice`,0)) as Q2,\n          sum(if(quarter(t1.createDate)='3',t1.`payPrice`,0)) as Q3,\n          sum(if(quarter(t1.createDate)='4',t1.`payPrice`,0)) as Q4\n        from\n          t_checkin t1\n          inner join t_room_type t2 on t2.id = t1.roomtypeid\n        where date_format(t1.`createDate`,'%Y')  = #{year}\n        group by t2.typeName\n    \u003c/select\u003e\n\n    \u003cselect id=\"getRoomTypeCountByYearAndMonth\" resultType=\"com.bdqn.vo.PieChartsVo\"\u003e\n        select\n          t2.`typeName` as name,\n          count(t1.`id`)  as value\n        from\n          t_orders t1\n          inner join t_room_type t2 on t2.id = t1.roomTypeId\n          where date_format(t1.`reserveDate`,'%Y-%m') = #{year}\n        group by t2.typeName\n    \u003c/select\u003e\n\n\n    \u003cselect id=\"getCurrentDateHotelByDate\" resultType=\"com.bdqn.vo.PieChartsVo\"\u003e\n       select t2.`typeName` as name,count(t1.id) as value from t_checkin t1\n        inner join t_room_type t2 on t2.id = t1.`roomTypeId`\n        where date_format(t1.`createDate`,'%Y-%m-%d') = #{date}\n        group by t2.`typeName`\n    \u003c/select\u003e\n\n\u003c/mapper\u003e\n",
    "path": "src/main/resources/mapper/ChartsMapper.xml",
    "model_usage_metrics": {
        "Duration": 1120179177,
        "OpenAiUsage": {
            "completion_tokens": 0,
            "prompt_tokens": 0,
            "total_tokens": 0,
            "completion_tokens_details": {
                "accepted_prediction_tokens": 0,
                "audio_tokens": 0,
                "reasoning_tokens": 0,
                "rejected_prediction_tokens": 0
            },
            "prompt_tokens_details": {
                "audio_tokens": 0,
                "cached_tokens": 0
            }
        }
    }
}